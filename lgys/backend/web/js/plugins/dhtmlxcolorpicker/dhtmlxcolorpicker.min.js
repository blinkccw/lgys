function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function dhtmlxEvent(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function dhtmlXColorPicker(a){var e,f,g,b,c,d;if(!(this instanceof dhtmlXColorPicker))return new dhtmlXColorPicker(a);switch(dhx4._eventable(this),b=this,c=void 0,d=null,this._nodes=[],this.activeNode=null,this._inputListenerId=null,this.base=null,this._globalNode=null,this.memory=null,this.skin=null,this.conf={cp_id:dhx4.newId(),x:0,y:0,c:0,indent:2,position:"right",customColors:!1,selectedColor:null,hide:!1,hideOnSelect:!1,lang:"en",closeable:!0},this.value={red:-1,blue:-1,green:-1,hue:-1,sat:-1,lum:-1},this._initMoveSelection=function(a){return a=a||event,"function"==typeof window.addEventListener?(b._controllerNodes.colorArea.addEventListener("mousemove",b._setMoveSelection,!1),document.body.addEventListener("mouseup",b._cleanMoveSelection,!1)):(b._controllerNodes.colorArea.attachEvent("onmousemove",b._setMoveSelection),document.body.attachEvent("onmouseup",b._cleanMoveSelection)),b._setMoveSelection(a,b._controllerNodes.colorArea),!1},this._cleanMoveSelection=function(){return"function"==typeof window.removeEventListener?(b._controllerNodes.colorArea.removeEventListener("mousemove",b._setMoveSelection,!1),document.body.removeEventListener("mouseup",b._cleanMoveSelection,!1)):(b._controllerNodes.colorArea.detachEvent("onmousemove",b._setMoveSelection),document.body.detachEvent("onmouseup",b._cleanMoveSelection)),!1},this._setMoveSelection=function(a){a=a||event;var c=b._getOffsetPosition(a,b._controllerNodes.colorArea);return b._controllerNodes.fr_cover?setTimeout(function(){b._setColorAreaXY(c.x,c.y),b._setColorByXYC()},0):(b._setColorAreaXY(c.x,c.y),b._setColorByXYC()),!1},this._initMoveContrast=function(a){a=a||event,"function"==typeof window.addEventListener?(document.body.addEventListener("mousemove",b._setMoveContrast,!1),document.body.addEventListener("mouseup",b._cleanMoveContrast,!1)):(document.body.attachEvent("onmousemove",b._setMoveContrast),document.body.attachEvent("onmouseup",b._cleanMoveContrast)),b._setMoveContrast(a,b._controllerNodes.contrastArea)},this._cleanMoveContrast=function(){"function"==typeof window.removeEventListener?(document.body.removeEventListener("mousemove",b._setMoveContrast,!1),document.body.removeEventListener("mouseup",b._cleanMoveContrast,!1)):(document.body.detachEvent("onmousemove",b._setMoveContrast),document.body.detachEvent("onmouseup",b._cleanMoveContrast))},this._setMoveContrast=function(a){a=a||event;var c=b._getOffsetPosition(a,b._controllerNodes.contrastArea);b._setContrastY(c.y),b._setColorByXYC(!0)},this._doOnSelectColor=function(){var a=b.colorAIP.rgb2hex({r:b.value.red,g:b.value.green,b:b.value.blue});null!=b.activeNode&&(b.activeNode.valueCont&&(b.activeNode.valueCont.value=a),b.activeNode.valueColor&&(b.activeNode.valueColor.style.backgroundColor=a)),(b.base._dhx_remove||b.conf.hideOnSelect)&&b.hide(),b.callEvent("onSelect",[a,b.activeNode?b.activeNode.node:null])},this._doOnCancel=function(){1==b.callEvent("onCancel",[b.activeNode?b.activeNode.node:null])&&1==b.conf.closeable&&b.hide()},this._doOnDefault=function(){b.callEvent("onDefault",[b.activeNode?b.activeNode.node:null])},this._doOnFocusByInput=function(){var a=this!=window?this:event.srcElement,c=b.activeNode&&b.activeNode.valueCont&&b.activeNode.valueCont==a?b.activeNode:b._getNodeByValueCont(a);b.activeNode=c,c&&c==b.activeNode&&b._initListenerInput()},this._doOnBlurByInput=function(){var a=this!=window?this:event.srcElement,c=b.activeNode&&b.activeNode.valueCont&&b.activeNode.valueCont==a?b.activeNode:b._getNodeByValueCont(a);c&&c==b.activeNode&&b._removeListenerInput()},this._doOnClickByNode=function(a){a=a||event;var c=this!=window?this:event.srcElement;b.activeNode=b.activeNode.node!=c?b._getNodeByElement(c):b.activeNode,b.isVisible()||b.show()},this.saveColor=function(){b.memory.setValue(b.value)},this._onSelectMemoryEl=function(a){var c;b._refreshCoordinatesByHSL(a.value.hue,a.value.sat,a.value.lum);for(c in a.value)b.value[c]=a.value[c];b._refreshContrast(),b._refreshInputValues(),b._refreshColorValue()},this._doOnClickByBody=function(a){a=a||event;var c=!0,d=a.target||a.srcElement;b._isBaseNode(d)&&(c=!1),c&&b.activeNode&&(b.activeNode.node==d||b.activeNode.valueCont==d)&&(c=!1),c&&b.hide()},this._doOnChangeHSL=function(){var e,a=parseInt(b._controllerNodes.hue.value),c=parseInt(b._controllerNodes.sat.value),d=parseInt(b._controllerNodes.lum.value);isNaN(a)||a>359||0>a?b._controllerNodes.hue.value=b.value.hue:b.value.hue=a,isNaN(c)||c>100||0>c?b._controllerNodes.sat.value=b.value.sat:b.value.sat=c,isNaN(d)||d>100||0>d?b._controllerNodes.lum.value=b.value.lum:b.value.lum=d,e=b.colorAIP.hsl2rgb(b.value.hue,b.value.sat/100,b.value.lum/100),b.value.red=Math.round(255*e.r),b.value.green=Math.round(255*e.g),b.value.blue=Math.round(255*e.b),b._refreshCoordinatesByHSL(b.value.hue,b.value.sat,b.value.lum),b._refreshContrast(),b._refreshInputValues(),b._refreshColorValue()},this._doOnChangeRGB=function(){var e,a=parseInt(b._controllerNodes.red.value),c=parseInt(b._controllerNodes.green.value),d=parseInt(b._controllerNodes.blue.value);isNaN(a)||a>255||0>a?b._controllerNodes.red.value=b.value.red:b.value.red=a,isNaN(c)||c>255||0>c?b._controllerNodes.green.value=b.value.green:b.value.green=c,isNaN(d)||d>255||0>d?b._controllerNodes.blue.value=b.value.blue:b.value.blue=d,e=b.colorAIP.rgb2hsl(b.value.red/255,b.value.green/255,b.value.blue/255),b.value.hue=Math.round(e.h),b.value.sat=Math.round(100*e.s),b.value.lum=Math.round(100*e.l),b._refreshCoordinatesByHSL(b.value.hue,b.value.sat,b.value.lum),b._refreshContrast(),b._refreshInputValues(),b._refreshColorValue()},this._doOnChangeHSV=function(){b._controllerNodes.hsv.value=b.setColor(b._controllerNodes.hsv.value)},this._checkType=function(a){var c;if(!(a instanceof Array))return void 0==a?null:"string"==typeof a?"string":a.tagName&&"input"==a.tagName.toLowerCase()?"input":a.tagName&&"textarea"==a.tagName.toLowerCase()?"textarea":a.tagName?"container":"object"==typeof a?"object":void 0;switch(c=b._checkType(a[0])){case"string":return"array_string";case"input":case"textarea":return"array_input";case"object":return"array_object";default:return void 0}},this._initByObject=function(a){a.parent&&a.parent.tagName?b.base=a.parent:"string"==typeof a.parent?b.base=document.getElementById(a.parent):(b.base=document.createElement("div"),b.base._dhx_remove=!0),a.color&&(b.conf.selectedColor=a.color),"undefined"!=typeof a.closeable&&(this.conf.closeable=dhx4.s2b(a.closeable)),a.custom_colors&&(this._tempInitCC=function(){var b,c;if(this.initMemoryColors(),this.conf.customColors=!0,a.custom_colors instanceof Array)for(c=a.custom_colors.length,b=0;c>b;b++)this.setCustomColors(a.custom_colors[b]);this.base.parentNode&&this.showMemory(),delete this._tempInitCC}),a.hide&&(b.conf.hide=!0),a.input&&b._addNode(a.input,a.target_color,a.target_value);var c=a.skin||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxcolorpicker")||"dhx_skyblue";b.setSkin(c),a.colors&&(b.initMemoryColors(),b.conf.customColors=!0),a.link&&b._addNode(a.link)},this.unload=function(){var a,c,e;for(this.isVisible()&&this.hide(),this.destructMemory(),c=this._nodes.length,a=0;c>a;a++){this._detachEventsFromNode(this._nodes[a]);for(e in this._nodes[a])this._nodes[a][e]=null;delete this._nodes[a]}this._nodes=null,this.base._dhx_remove?delete this.base._dhx_remove:this.base.className=this.base.className.replace(/\s?dhtmlxcp_\S*/,""),"function"==typeof window.addEventListener?(this._controllerNodes.colorArea.removeEventListener("mousedown",this._initMoveSelection,!1),this._controllerNodes.colorArea.removeEventListener("dblclick",this._doOnSelectColor,!1),this._controllerNodes.contrastArea.removeEventListener("mousedown",this._initMoveContrast,!1),this._controllerNodes.button_default.removeEventListener("click",this._doOnDefault,!1),this._controllerNodes.button_save.removeEventListener("click",this._doOnSelectColor,!1),this._controllerNodes.button_cancel.removeEventListener("click",this._doOnCancel,!1),this._controllerNodes.hue.removeEventListener("change",this._doOnChangeHSL,!1),this._controllerNodes.sat.removeEventListener("change",this._doOnChangeHSL,!1),this._controllerNodes.lum.removeEventListener("change",this._doOnChangeHSL,!1),this._controllerNodes.red.removeEventListener("change",this._doOnChangeRGB,!1),this._controllerNodes.green.removeEventListener("change",this._doOnChangeRGB,!1),this._controllerNodes.blue.removeEventListener("change",this._doOnChangeRGB,!1),this._controllerNodes.hsv.removeEventListener("change",this._doOnChangeHSV,!1)):(this._controllerNodes.colorArea.detachEvent("onmousedown",this._initMoveSelection),this._controllerNodes.colorArea.detachEvent("ondblclick",this._doOnSelectColor),this._controllerNodes.contrastArea.detachEvent("onmousedown",this._initMoveContrast),this._controllerNodes.button_default.detachEvent("onclick",this._doOnDefault),this._controllerNodes.button_save.detachEvent("onclick",this._doOnSelectColor),this._controllerNodes.button_cancel.detachEvent("onclick",this._doOnCancel),this._controllerNodes.hue.detachEvent("onchange",this._doOnChangeHSL),this._controllerNodes.sat.detachEvent("onchange",this._doOnChangeHSL),this._controllerNodes.lum.detachEvent("onchange",this._doOnChangeHSL),this._controllerNodes.red.detachEvent("onchange",this._doOnChangeRGB),this._controllerNodes.green.detachEvent("onchange",this._doOnChangeRGB),this._controllerNodes.blue.detachEvent("onchange",this._doOnChangeRGB),this._controllerNodes.hsv.detachEvent("onchange",this._doOnChangeHSV)),this._controllerNodes.fr_cover&&(this._controllerNodes.fr_cover.parentNode&&this._controllerNodes.fr_cover.parentNode.removeChild(this._controllerNodes.fr_cover),delete this._controllerNodes.fr_cover),dhx4.zim.clear(this.conf.cp_id),dhx4._eventable(this,"clear");for(e in this)this[e]=null;b=null,d=null,g=null},c=this._checkType(a)){case"object":b._initByObject(a);break;case"input":case"textarea":b._initByObject({}),this._addNode(a);break;case"string":return d=document.getElementById(a),new dhtmlXColorPicker(d);case"container":b._initByObject({parent:a});break;case null:b._initByObject({});break;case"array_string":case"array_input":for(b._initByObject({}),f=a.length,e=0;f>e;e++)this._addNode(a[e]);break;case"array_object":for(b._initByObject({}),f=a.length,e=0;f>e;e++)g=this._addNode(a[e].input,a[e].target_color,a[e].target_value).conf,g.customColors=void 0!=a[e].custom_colors?dhx4.s2b(a[e].custom_colors):g.customColors,g.selectedColor=void 0!=a[e].color?a[e].color:g.selectedColor}if(this.base.innerHTML="<div class='dhxcp_g_area'><div class='dhxcp_sub_area'><div class='dhxcp_g_color_area'><div class='dhxcp_color_selector'><div class='dhxcp_v_line'></div><div class='dhxcp_h_line'></div></div><div class='dhxcp_contrast_area'><div class='dhxcp_h_line'></div></div></div><div class='dhxcp_g_input_area'><div class='dhxcp_value_cont'><div class='dhxcp_value_color'></div><input type='text' class='dhxcp_value'/></div><table class='dhxcp_inputs_cont' cellpadding='0' cellspacing='0' border='0'><tr><td class='dhxcp_label_hsl'>"+this.i18n[this.conf.lang].labelHue+"</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>"+this.i18n[this.conf.lang].labelRed+"</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr><tr><td class='dhxcp_label_hsl'>"+this.i18n[this.conf.lang].labelSat+"</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>"+this.i18n[this.conf.lang].labelGreen+"</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr><tr><td class='dhxcp_label_hsl'>"+this.i18n[this.conf.lang].labelLum+"</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>"+this.i18n[this.conf.lang].labelBlue+"</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr></table></div><div class='dhxcp_g_memory_area'></div><div class='dhxcp_buttons_area'><button class='dhx_button_default'>默认</button><button class='dhx_button_save'>"+this.i18n[this.conf.lang].btnSelect+"</button><button class='dhx_button_cancel'>"+this.i18n[this.conf.lang].btnCancel+"</button></div></div>",this._globalNode=this.base.firstChild,this._controllerNodes={colorArea:this._globalNode.firstChild.firstChild.firstChild,v_line:this._globalNode.firstChild.firstChild.firstChild.childNodes[0],h_line:this._globalNode.firstChild.firstChild.firstChild.childNodes[1],contrastArea:this._globalNode.firstChild.firstChild.childNodes[1],contrast_line:this._globalNode.firstChild.firstChild.childNodes[1].firstChild,color:this._globalNode.firstChild.childNodes[1].childNodes[0].firstChild,hsv:this._globalNode.firstChild.childNodes[1].childNodes[0].childNodes[1],hue:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[1].firstChild,sat:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[1].firstChild,lum:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[1].firstChild,red:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[3].firstChild,green:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[3].firstChild,blue:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[3].firstChild,memory_block:this._globalNode.firstChild.childNodes[2],button_default:this._globalNode.firstChild.childNodes[3].firstChild,button_save:this._globalNode.firstChild.childNodes[3].childNodes[1],button_cancel:this._globalNode.firstChild.childNodes[3].childNodes[2]},this._labelNodes={labelHue:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].firstChild,labelSat:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].firstChild,labelLum:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].firstChild,labelRed:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[2],labelGreen:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[2],labelBlue:this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[2],btnAddColor:null,btnSelect:this._globalNode.firstChild.childNodes[3].firstChild,btnCancel:this._globalNode.firstChild.childNodes[3].childNodes[1]},"function"==typeof this._tempInitCC&&this._tempInitCC(),"function"==typeof window.addEventListener?(this._controllerNodes.colorArea.addEventListener("mousedown",this._initMoveSelection,!1),this._controllerNodes.colorArea.addEventListener("dblclick",this._doOnSelectColor,!1),this._controllerNodes.contrastArea.addEventListener("mousedown",this._initMoveContrast,!1),this._controllerNodes.button_default.addEventListener("click",this._doOnDefault,!1),this._controllerNodes.button_save.addEventListener("click",this._doOnSelectColor,!1),this._controllerNodes.button_cancel.addEventListener("click",this._doOnCancel,!1),this._controllerNodes.hue.addEventListener("change",this._doOnChangeHSL,!1),this._controllerNodes.sat.addEventListener("change",this._doOnChangeHSL,!1),this._controllerNodes.lum.addEventListener("change",this._doOnChangeHSL,!1),this._controllerNodes.red.addEventListener("change",this._doOnChangeRGB,!1),this._controllerNodes.green.addEventListener("change",this._doOnChangeRGB,!1),this._controllerNodes.blue.addEventListener("change",this._doOnChangeRGB,!1),this._controllerNodes.hsv.addEventListener("change",this._doOnChangeHSV,!1)):(this._controllerNodes.colorArea.attachEvent("onmousedown",this._initMoveSelection),this._controllerNodes.colorArea.attachEvent("ondblclick",this._doOnSelectColor),this._controllerNodes.contrastArea.attachEvent("onmousedown",this._initMoveContrast),this._controllerNodes.button_default.attachEvent("onclick",this._doOnDefault),this._controllerNodes.button_save.attachEvent("onclick",this._doOnSelectColor),this._controllerNodes.button_cancel.attachEvent("onclick",this._doOnCancel),this._controllerNodes.hue.attachEvent("onchange",this._doOnChangeHSL),this._controllerNodes.sat.attachEvent("onchange",this._doOnChangeHSL),this._controllerNodes.lum.attachEvent("onchange",this._doOnChangeHSL),this._controllerNodes.red.attachEvent("onchange",this._doOnChangeRGB),this._controllerNodes.green.attachEvent("onchange",this._doOnChangeRGB),this._controllerNodes.blue.attachEvent("onchange",this._doOnChangeRGB),this._controllerNodes.hsv.attachEvent("onchange",this._doOnChangeHSV)),this.setColor(this.conf.selectedColor||"#ffffff"),this._nodes.length)for(e=0;e<this._nodes.length;e++)this._attachEventsToNode(this._nodes[e]);this.conf.hide&&this.hide(),"function"==typeof this._cpInitFRM&&this._cpInitFRM()}"undefined"==typeof window.dhx4&&(window.dhx4={version:"4.4",skin:null,skinDetect:function(a){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(a+"_skin_detect")]||null},readFromCss:function(a,b){var d,c=document.createElement("DIV");return c.className=a,null!=document.body.firstChild?document.body.insertBefore(c,document.body.firstChild):document.body.appendChild(c),d=c[b||"offsetWidth"],c.parentNode.removeChild(c),c=null,d},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var b,a=this.first();for(b in this.data)a=Math.max(a,this.data[b]);return a},reserve:function(a){return this.data[a]=this.last()+this.step,this.data[a]},clear:function(a){null!=this.data[a]&&(this.data[a]=null,delete this.data[a])}},s2b:function(a){return"string"==typeof a&&(a=a.toLowerCase()),1==a||1==a||"true"==a||"1"==a||"yes"==a||"y"==a||"on"==a},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(e){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(a){return"string"==typeof a&&(a=document.getElementById(a)),this.getOffset(a).left},absTop:function(a){return"string"==typeof a&&(a=document.getElementById(a)),this.getOffset(a).top},_aOfs:function(a){for(var b=0,c=0;a;)b+=parseInt(a.offsetTop),c+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:b,left:c}},_aOfsRect:function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}},getOffset:function(a){return a.getBoundingClientRect?this._aOfsRect(a):this._aOfs(a)},_isObj:function(a){return null!=a&&"object"==typeof a&&"undefined"==typeof a.length},_copyObj:function(a){var b,c;if(this._isObj(a)){b={};for(c in a)b[c]="object"==typeof a[c]&&null!=a[c]?this._copyObj(a[c]):a[c]}else for(b=[],c=0;c<a.length;c++)b[c]="object"==typeof a[c]&&null!=a[c]?this._copyObj(a[c]):a[c];return b},screenDim:function(){var a=navigator.userAgent.indexOf("MSIE")>=0,b={};return b.left=document.body.scrollLeft,b.right=b.left+(window.innerWidth||document.body.clientWidth),b.top=Math.max((a?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),b.bottom=b.top+(a?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),b},selectTextRange:function(a,b,c){var d,f;if(a="string"==typeof a?document.getElementById(a):a,d=a.value.length,b=Math.max(Math.min(b,d),0),c=Math.min(c,d),a.setSelectionRange)try{a.setSelectionRange(b,c)}catch(e){}else if(a.createTextRange){f=a.createTextRange(),f.moveStart("character",b),f.moveEnd("character",c-d);try{f.select()}catch(e){}}},transData:null,transDetect:function(){var a,b;if(null==this.transData){this.transData={transProp:!1,transEv:null},a={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(b in a)0==this.transData.transProp&&null!=document.documentElement.style[b]&&(this.transData.transProp=b,this.transData.transEv=a[b]);a=null}return this.transData},_xmlNodeValue:function(a){var c,b="";for(c=0;c<a.childNodes.length;c++)b+=null!=a.childNodes[c].nodeValue?a.childNodes[c].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return b}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE9=navigator.userAgent.indexOf("MSIE 9.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE10=navigator.userAgent.indexOf("MSIE 10.0")>=0&&navigator.userAgent.indexOf("Trident")>=0&&1!=window.navigator.pointerEnabled,window.dhx4.isIE11=navigator.userAgent.indexOf("Trident")>=0&&1==window.navigator.pointerEnabled,window.dhx4.isEdge=navigator.userAgent.indexOf("Edge")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0&&!window.dhx4.isEdge,window.dhx4.isKHTML=(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0)&&!window.dhx4.isEdge,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0,window.dhx4.dnd={evs:{},p_en:(window.dhx4.isIE||window.dhx4.isEdge)&&(window.navigator.pointerEnabled||window.navigator.msPointerEnabled),_mTouch:function(a){return window.dhx4.isIE10&&a.pointerType==a.MSPOINTER_TYPE_MOUSE||window.dhx4.isIE11&&"mouse"==a.pointerType||window.dhx4.isEdge&&"mouse"==a.pointerType},_touchOn:function(a){null==a&&(a=document.body),a.style.touchAction=a.style.msTouchAction="",a=null},_touchOff:function(a){null==a&&(a=document.body),a.style.touchAction=a.style.msTouchAction="none",a=null}},1==window.navigator.pointerEnabled?window.dhx4.dnd.evs={start:"pointerdown",move:"pointermove",end:"pointerup"}:1==window.navigator.msPointerEnabled?window.dhx4.dnd.evs={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:"undefined"!=typeof window.addEventListener&&(window.dhx4.dnd.evs={start:"touchstart",move:"touchmove",end:"touchend"})),"undefined"==typeof window.dhx4.template&&(window.dhx4.trim=function(a){return String(a).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(a,b,c){return a.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var g,h,a=arguments[1],d=window.dhx4.trim(arguments[3]),e=null,f=[b[a]];if(d.length>0){for(d=d.split(":"),g=[],h=0;h<d.length;h++)h>0&&null!=g[g.length-1].match(/\\$/)?g[g.length-1]=g[g.length-1].replace(/\\$/,"")+":"+d[h]:g.push(d[h]);for(e=g[0],h=1;h<g.length;h++)f.push(g[h])}return"string"==typeof e&&"function"==typeof window.dhx4.template[e]?window.dhx4.template[e].apply(window.dhx4.template,f):a.length>0&&"undefined"!=typeof b[a]?1==c?window.dhx4.trim(b[a]):String(b[a]):""})},window.dhx4.template.date=function(a,b){return null!=a?a instanceof Date?window.dhx4.date2str(a,b):(a=a.toString(),null!=a.match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(a)),b):a):""},window.dhx4.template.maxlength=function(a,b){return String(a).substr(0,b)},window.dhx4.template.number_format=function(a,b,c,d){var e=window.dhx4.template._parseFmt(b,c,d);return 0==e?a:window.dhx4.template._getFmtValue(a,e)},window.dhx4.template.lowercase=function(a){return("undefined"==typeof a||null==a)&&(a=""),String(a).toLowerCase()},window.dhx4.template.uppercase=function(a){return("undefined"==typeof a||null==a)&&(a=""),String(a).toUpperCase()},window.dhx4.template._parseFmt=function(a,b,c){var e,f,g,d=a.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);return null==d||4!=d.length?!1:(e={i_len:!1,i_sep:"string"==typeof b?b:",",d_len:!1,d_sep:"string"==typeof c?c:".",s_bef:"string"==typeof d[1]?d[1]:"",s_aft:"string"==typeof d[3]?d[3]:""},f=d[2].split("."),null!=f[1]&&(e.d_len=f[1].length),g=f[0].split(","),g.length>1&&(e.i_len=g[g.length-1].length),e)},window.dhx4.template._getFmtValue=function(value,fmt){var v0,i,v1,q,t1,r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){if(v0="",null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,fmt.i_len!==!1){for(i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(fmt.d_len!==!1){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);"),t1=r[4].match(dhx4.temp),null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft}return value}),"undefined"==typeof window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(a,b,c){var d,e,f;return(null==b||"undefnied"==typeof b)&&(b=window.dhx4.dateFormat[window.dhx4.dateLang]),(null==c||"undefnied"==typeof c)&&(c=window.dhx4.dateStrings[window.dhx4.dateLang]),a instanceof Date&&(d=function(a){return 1==String(a).length?"0"+String(a):a},e=function(b){var e,f,g;switch(b){case"%d":return d(a.getDate());case"%j":return a.getDate();case"%D":return c.dayShortName[a.getDay()];case"%l":return c.dayFullName[a.getDay()];case"%m":return d(a.getMonth()+1);case"%n":return a.getMonth()+1;case"%M":return c.monthShortName[a.getMonth()];case"%F":return c.monthFullName[a.getMonth()];case"%y":return d(a.getYear()%100);case"%Y":return a.getFullYear();case"%g":return(a.getHours()+11)%12+1;case"%h":return d((a.getHours()+11)%12+1);case"%G":return a.getHours();case"%H":return d(a.getHours());case"%i":return d(a.getMinutes());case"%s":return d(a.getSeconds());case"%a":return a.getHours()>11?"pm":"am";case"%A":return a.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return a.getMilliseconds();case"%P":return null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz?window.dhx4.temp_calendar.tz:(e=a.getTimezoneOffset(),f=Math.abs(Math.floor(e/60)),g=Math.abs(e)-60*f,(e>0?"-":"+")+d(f)+":"+d(g));default:return b}},f=String(b||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,e)),f||String(a)},window.dhx4.str2date=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;if((null==b||"undefnied"==typeof b)&&(b=window.dhx4.dateFormat[window.dhx4.dateLang]),(null==c||"undefnied"==typeof c)&&(c=window.dhx4.dateStrings[window.dhx4.dateLang]),b=b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&"),d=[],e=[],b=b.replace(/%[a-z]/gi,function(a){switch(a){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return e.push(a),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return e.push(a),"([a-zéûäа-яё]{1,})";case"%j":case"%n":case"%g":case"%G":return e.push(a),"(\\d{1,2})";case"%Y":return e.push(a),"(\\d{4})";case"%a":return e.push(a),"([a|p]m)";case"%A":return e.push(a),"([A|P]M)";case"%u":return e.push(a),"(\\d{1,6})";case"%P":return e.push(a),"([+-]\\d{1,2}:\\d{1,2})"}return a}),f=new RegExp(b,"i"),g=a.match(f),null==g||g.length-1!=e.length)return"Invalid Date";for(h=1;h<g.length;h++)d.push(g[h]);for(i={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},j={},k={},h=0;h<e.length;h++)"undefined"!=typeof i[e[h]]&&(l=i[e[h]],j[l]||(j[l]=[],k[l]=[]),j[l].push(d[h]),k[l].push(e[h]));for(d=[],e=[],h=1;7>=h;h++)if(null!=j[h])for(m=0;m<j[h].length;m++)d.push(j[h][m]),e.push(k[h][m]);for(n=new Date,n.setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),o=function(a,b){for(var c=0;c<b.length;c++)if(b[c].toLowerCase()==a)return c;return-1},h=0;h<d.length;h++)switch(e[h]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(d[h])||n[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[e[h]]](Number(d[h])+("%m"==e[h]||"%n"==e[h]?-1:0));break;case"%M":case"%F":p=o(d[h].toLowerCase(),c[{"%M":"monthShortName","%F":"monthFullName"}[e[h]]]),p>=0&&n.setMonth(p);break;case"%y":isNaN(d[h])||(q=Number(d[h]),n.setFullYear(q+(q>50?1900:2e3)));break;case"%g":case"%h":isNaN(d[h])||(q=Number(d[h]),12>=q&&q>=0&&n.setHours(q+(o("pm",d)>=0?12==q?0:12:12==q?-12:0)));break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=d[h])}return n}),"undefined"==typeof window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(a){var b;return"string"!=typeof a?a:(a=a.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE?b=(new window.DOMParser).parseFromString(a,"text/xml"):window.ActiveXObject!==window.undefined&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)),b)},xmltop:function(a,b,c){if(("undefined"==typeof b.status||b.status<400)&&(xml=b.responseXML?b.responseXML||b:dhx4.ajax.parse(b.responseText||b),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(a)[0]}catch(d){}return-1!==c&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],c]),document.createElement("DIV")},xpath:function(a,b){var d,e,f;if(b.nodeName||(b=b.responseXML||b),!dhx4.isIE){for(d=[],f=(b.ownerDocument||b).evaluate(a,b,null,XPathResult.ANY_TYPE,null);e=f.iterateNext();)d.push(e);return d}try{return b.selectNodes(a)||[]}catch(c){return[]}},query:function(a){dhx4.ajax._call(a.method||"GET",a.url,a.data||"",a.async||!0,a.callback,null,a.headers)},get:function(a,b){return this._call("GET",a,null,!0,b)},getSync:function(a){return this._call("GET",a,null,!1)},put:function(a,b,c){return this._call("PUT",a,b,!0,c)},del:function(a,b,c){return this._call("DELETE",a,b,!0,c)},post:function(a,b,c){return 1==arguments.length?b="":2!=arguments.length||"function"!=typeof b&&"function"!=typeof window[b]?b=String(b):(c=b,b=""),this._call("POST",a,b,!0,c)},postSync:function(a,b){return b=null==b?"":String(b),this._call("POST",a,b,!1)},getLong:function(a,b){this._call("GET",a,null,!0,b,{url:a})},postLong:function(a,b,c){2==arguments.length&&(c=b,b=""),this._call("POST",a,b,!0,c,{url:a,postData:b})},_call:function(a,b,c,d,e,f,g){var j,h=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),i=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==d&&(h.onreadystatechange=function(){if(4==h.readyState||1==i&&3==h.readyState){if((200!=h.status||""==h.responseText)&&!dhx4.callEvent("onAjaxError",[{xmlDoc:h,filePath:b,async:d}]))return;window.setTimeout(function(){"function"==typeof e&&e.apply(window,[{xmlDoc:h,filePath:b,async:d}]),null!=f&&("undefined"!=typeof f.postData?dhx4.ajax.postLong(f.url,f.postData,e):dhx4.ajax.getLong(f.url,e)),e=null,h=null},1)}}),"GET"==a&&1!=this.cache&&(b+=(b.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),h.open(a,b,d),null!=g)for(j in g)h.setRequestHeader(j,g[j]);else"POST"==a||"PUT"==a||"DELETE"==a?h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==a&&(c=null);
return h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.send(c),{xmlDoc:h,filePath:b,async:d}}}),"undefined"==typeof window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(a,b,c,d,e){var f,g;if("clear"==e){for(f in a._dhxdataload)a._dhxdataload[f]=null,delete a._dhxdataload[f];return a._loadData=null,a._dhxdataload=null,a.load=null,a.loadStruct=null,a=null,void 0}if(a._dhxdataload={initObj:b,xmlToJson:c,xmlRootTag:d,onBeforeXLS:null},a._loadData=function(a,b,c){var d,e,f,g,h,i,j;if(2==arguments.length&&(c=b,b=null),d=null,3==arguments.length&&(c=arguments[2]),"string"==typeof a){if(e=a.replace(/^\s{1,}/,"").replace(/\s{1,}$/,""),f=new RegExp("^<"+this._dhxdataload.xmlRootTag),f.test(e.replace(/^<\?xml[^\?]*\?>\s*/,""))&&(d=dhx4.ajax.parse(a),null!=d&&(d=this[this._dhxdataload.xmlToJson].apply(this,[d]))),null!=d||null==e.match(/^[\s\S]*{[.\s\S]*}[\s\S]*$/)&&null==e.match(/^[\s\S]*\[[.\s\S]*\][\s\S]*$/)||(d=dhx4.s2j(e)),null==d){if(this.callEvent("onXLS",[]),g=[],"function"==typeof this._dhxdataload.onBeforeXLS&&(e=this._dhxdataload.onBeforeXLS.apply(this,[a]),null!=e&&"object"==typeof e&&(null!=e.url&&(a=e.url),null!=e.params)))for(h in e.params)g.push(h+"="+encodeURIComponent(e.params[h]));return i=this,j=function(b){var d=null;d=(b.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=b.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?i[i._dhxdataload.xmlToJson].apply(i,[b.xmlDoc.responseXML]):dhx4.s2j(b.xmlDoc.responseText),null!=d&&i[i._dhxdataload.initObj].apply(i,[d,a]),i.callEvent("onXLE",[]),null!=c&&("function"==typeof c?c.apply(i,[]):"function"==typeof window[c]&&window[c].apply(i,[])),j=c=null,d=b=i=null},g=g.join("&")+("string"==typeof b?"&"+b:""),"post"==dhx4.ajax.method?dhx4.ajax.post(a,g,j):"get"==dhx4.ajax.method&&dhx4.ajax.get(a+(g.length>0?(a.indexOf("?")>0?"&":"?")+g:""),j),void 0}}else d="object"==typeof a.documentElement||"undefined"!=typeof a.tagName&&"undefined"!=typeof a.getElementsByTagName&&a.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[a]):window.dhx4._copyObj(a);null!=d&&this[this._dhxdataload.initObj].apply(this,[d]),null!=c&&("function"==typeof c?c.apply(this,[]):"function"==typeof window[c]&&window[c].apply(this,[]),c=null)},null!=e){g={struct:"loadStruct",data:"load"};for(f in e)1==e[f]&&(a[g[f]]=function(){return this._loadData.apply(this,arguments)})}a=null}),"undefined"==typeof window.dhx4._eventable&&(window.dhx4._eventable=function(a,b){return"clear"==b?(a.detachAllEvents(),a.dhxevs=null,a.attachEvent=null,a.detachEvent=null,a.checkEvent=null,a.callEvent=null,a.detachAllEvents=null,a=null,void 0):(a.dhxevs={data:{}},a.attachEvent=function(a,b){a=String(a).toLowerCase(),this.dhxevs.data[a]||(this.dhxevs.data[a]={});var c=window.dhx4.newId();return this.dhxevs.data[a][c]=b,c},a.detachEvent=function(a){var b,c,d;for(b in this.dhxevs.data){c=0;for(d in this.dhxevs.data[b])d==a?(this.dhxevs.data[b][d]=null,delete this.dhxevs.data[b][d]):c++;0==c&&(this.dhxevs.data[b]=null,delete this.dhxevs.data[b])}},a.checkEvent=function(a){return a=String(a).toLowerCase(),null!=this.dhxevs.data[a]},a.callEvent=function(a,b){var c,d;if(a=String(a).toLowerCase(),null==this.dhxevs.data[a])return!0;c=!0;for(d in this.dhxevs.data[a])c=this.dhxevs.data[a][d].apply(this,b)&&c;return c},a.detachAllEvents=function(){var a,b;for(a in this.dhxevs.data){for(b in this.dhxevs.data[a])this.dhxevs.data[a][b]=null,delete this.dhxevs.data[a][b];this.dhxevs.data[a]=null,delete this.dhxevs.data[a]}},a=null,void 0)},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(a){return""==a},isNotEmpty:function(a){return a instanceof Array?a.length>0:""==!a},isValidBoolean:function(a){return!!a.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(a){return!!a.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(a){return!!a.toString().match(/(^-?\d+$)/)},isValidNumeric:function(a){return!!a.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(a){return!!a.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(a){var b=a.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return b&&!!(b[1]<=9999&&b[2]<=12&&b[3]<=31&&b[4]<=59&&b[5]<=59&&b[6]<=59)||!1},isValidDate:function(a){var b=a.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return b&&!!(b[1]<=9999&&b[2]<=12&&b[3]<=31)||!1},isValidTime:function(a){var b=a.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return b&&!!(b[1]<=24&&b[2]<=59&&b[3]<=59)||!1},isValidIPv4:function(a){var b=a.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return b&&!!(b[1]<=255&&b[2]<=255&&b[3]<=255&&b[4]<=255)||!1},isValidCurrency:function(a){return a.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)&&!0||!1},isValidSSN:function(a){return a.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&!0||!1},isValidSIN:function(a){return a.toString().match(/^\d{9}$/)&&!0||!1}},dhtmlxValidation=new dhtmlxValidation),"undefined"==typeof window.dhtmlx&&(window.dhtmlx={extend:function(a,b){for(var c in b)a[c]||(a[c]=b[c]);return a},extend_api:function(a,b,c){var d=window[a];d&&(window[a]=function(a){var c,e;if(a&&"object"==typeof a&&!a.tagName){c=d.apply(this,b._init?b._init(a):arguments);for(e in dhtmlx)b[e]&&this[b[e]](dhtmlx[e]);for(e in a)b[e]?this[b[e]](a[e]):0===e.indexOf("on")&&this.attachEvent(e,a[e])}else c=d.apply(this,arguments);return b._patch&&b._patch(this),c||this},window[a].prototype=d.prototype,c&&dhtmlx.extend(window[a].prototype,c))},url:function(a){return-1!=a.indexOf("?")?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null,a.dragStarter=null,a.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,b){a.onmousedown=this.preCreateDragCopy,a.dragStarter=b,this.addDragLanding(a,b)},dhtmlDragAndDropObject.prototype.addDragLanding=function(a,b){a.dragLanding=b},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){return!a&&!window.event||2!=(a||event).button?window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(a),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),a&&a.preventDefault?(a.preventDefault(),!1):!1):void 0},dhtmlDragAndDropObject.prototype.callDrag=function(a){var b,c,d,e;if(a||(a=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(a,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,a),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode&&(b=dragger.gldragNode,dragger.gldragNode.old&&(b=dragger.gldragNode.old),b.parentNode.removeChild(b),c=dragger.dragNode.pWindow,b.pWindow&&b.pWindow.dhtmlDragAndDrop.lastLanding&&b.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(b.pWindow.dhtmlDragAndDrop.lastLanding),_isIE?(d=document.createElement("Div"),d.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=d.childNodes[0]):dragger.dragNode=dragger.dragNode.cloneNode(!0),dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),c.dhtmlDragAndDrop.dragNode=dragger.dragNode),dragger.dragNode.style.left=a.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=a.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",e=a.srcElement?a.srcElement:a.target,dragger.checkLanding(e,a)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(a){var b,c,d,e;if(window.name){for(b=parent.frames[window.name].frameElement.offsetParent,c=0,d=0;b;)c+=b.offsetLeft,d+=b.offsetTop,b=b.offsetParent;if(parent.dhtmlDragAndDrop&&(e=parent.dhtmlDragAndDrop.calculateFramePosition(1),c+=1*e.split("_")[0],d+=1*e.split("_")[1]),a)return c+"_"+d;this.fx=c,this.fy=d}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(a,b){a&&a.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=a,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,b.clientX,b.clientY,b),this.lastLanding_scr=_isIE?b.srcElement:b.target):a&&"BODY"!=a.tagName?this.checkLanding(a.parentNode,b):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,b.clientX,b.clientY,b),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(a,b){if(dragger=window.dhtmlDragAndDrop,!b){dragger.stopFrameRoute();var c=dragger.lastLanding;dragger.lastLanding=null,c&&c.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,c,_isIE?event.srcElement:a.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(a){a&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var b=0;b<window.frames.length;b++)try{window.frames[b]!=a&&window.frames[b].dhtmlDragAndDrop&&window.frames[b].dhtmlDragAndDrop.stopFrameRoute(window)}catch(c){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(c){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(a,b){a&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=a.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=a.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=a.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=a.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&b&&(!_isFF||1.8>_FFrv)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(c){}for(var d=0;d<window.frames.length;d++)try{window.frames[d]!=a&&window.frames[d].dhtmlDragAndDrop&&window.frames[d].dhtmlDragAndDrop.initFrameRoute(window,!a||b?1:0)}catch(c){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),"undefined"==typeof window.dhtmlxEvent,null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),"undefined"==typeof dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){function e(){if(b){var c=document.createEvent("HTMLEvents");c.initEvent("dblclick",!0,!0),b.dispatchEvent(c),a=b=null}}var a,b,c,d;dhtmlxEvent(document.body,"touchstart",function(f){b=f.touches[0].target,c=f.touches[0].clientX,d=f.touches[0].clientY,a=window.setTimeout(e,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(e){a&&(Math.abs(e.touches[0].clientX-c)>50||Math.abs(e.touches[0].clientY-d)>50)&&(window.clearTimeout(a),a=b=!1)}),dhtmlxEvent(document.body,"touchend",function(){a&&(window.clearTimeout(a),a=b=!1)}),dhtmlxEvent.initTouch=function(){}}),dhtmlXColorPicker.prototype.linkTo=function(a,b,c){1==arguments.length&&(b=c=a);var d;return a=a||null,c=c||null,"string"==typeof b&&(b=document.getElementById(b)),d=this._addNode(b,a,c),d&&this._attachEventsToNode(d),d},dhtmlXColorPicker.prototype._isBaseNode=function(a){return a==this.base?!0:a.parentElement==document.body?!1:a.parentElement?this._isBaseNode(a.parentElement):!1},dhtmlXColorPicker.prototype._hasInput=function(a){var b,c,d=!1;for(c=this._nodes.length,b=0;c>b;b++)if(this._nodes[b].valueCont==a){d=!0;break}return d},dhtmlXColorPicker.prototype._findNodesByArray=function(a){var b,c,d;for(c=a.length,b=0;c>b;b++)d="string"==typeof a[b]?document.getElementById(a[b]):a[b],d&&this._addNode(d)},dhtmlXColorPicker.prototype._addNode=function(a,b,c){var d,e,f,g;return d="string"==typeof a?document.getElementById(a):a,"string"==typeof b&&(b=document.getElementById(b)),"string"==typeof c&&(c=document.getElementById(c)),d?(dhx4.s2b(d.getAttribute("colorbox"))&&(e=document.createElement("div"),e.style.width=d.offsetWidth+"px",e.style.height=d.offsetHeight+"px",d.style.width=d.offsetWidth-(d.offsetHeight+8)+"px",d.parentNode.insertBefore(e,d),e.style.position="relative",f=document.createElement("div"),e.appendChild(d),e.appendChild(f),f.className="dhxcp_colorBox",d.className+=" dhxcp_colorInput",f.style.width=f.style.height=d.offsetHeight+"px"),g={node:d,valueColor:void 0!=b?b:f||d,valueCont:void 0!=c?c:d,conf:{customColors:null!=d.getAttribute("customcolors")?dhx4.s2b(d.getAttribute("customcolors")):null,selectedColor:d.getAttribute("selectedcolor")}},this._nodes.push(g),this.activeNode||(this.activeNode=g),g):null},dhtmlXColorPicker.prototype.getNode=function(a){var b=null,c=null;return b="string"==typeof a?document.getElementById(a):a,void 0!=b.tagName&&(c=this._getNodeByElement(b)),c},dhtmlXColorPicker.prototype._getNodeByElement=function(a){var c,d,b=null;for(d=this._nodes.length,c=0;d>c;c++)this._nodes[c].node==a&&(b=this._nodes[c]);return b},dhtmlXColorPicker.prototype._getNodeByValueCont=function(a){var c,d,b=null;for(d=this._nodes.length,c=0;d>c;c++)this._nodes[c].valueCont&&this._nodes[c].valueCont==a&&(b=this._nodes[c]);return b},dhtmlXColorPicker.prototype.initMemoryColors=function(){var b,a=this;this._controllerNodes.memory_block.innerHTML="<div class='dhxcp_memory_button_cont'><button class='dhxcp_save_to_memory'><div class='dhxcp_label_bm'>"+this.i18n[this.conf.lang].btnAddColor+"</div></button></div><div class='dhxcp_memory_els_cont'><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a></div>",this.memory=new this.Memory(this._controllerNodes.memory_block.childNodes[1]),this.memory.onSelect=this._onSelectMemoryEl,this.memory.onSave=function(b){var c=a.colorAIP.rgb2hex({r:b.red,g:b.green,b:b.blue});a.callEvent("onSaveColor",[c])},b=this._controllerNodes.memory_block.childNodes[0].firstChild,this._labelNodes.btnAddColor=this._controllerNodes.memory_block.childNodes[0].firstChild.firstChild,"function"==typeof window.addEventListener?b.addEventListener("click",this.saveColor,!1):b.attachEvent("onclick",this.saveColor)},dhtmlXColorPicker.prototype._refreshCoordinatesByHSL=function(a,b,c){var d,e,f;d=Math.round((this.configColorArea.maxX-this.configColorArea.minX)*a/359)+this.configColorArea.minX,e=Math.round((this.configColorArea.maxY-this.configColorArea.minY)*(100-c)/100)+this.configColorArea.minY,f=Math.round((this.configColorArea.maxY-this.configColorArea.minY)*(100-b)/100)+this.configColorArea.minY,this._setColorAreaXY(d,e),this._setContrastY(f)},dhtmlXColorPicker.prototype._parseColor=function(a){var b,c;return a instanceof Array?b={r:parseInt(a[0]),g:parseInt(a[1]),b:parseInt(a[2])}:"string"==typeof a&&(a=a.replace(/\s/g,""),/^rgb\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\)$/i.test(a)?(c=a.match(/^rgb\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\)$/i),b={r:parseInt(c[1]),g:parseInt(c[2]),b:parseInt(c[3])}):b=this.colorAIP.hex2rgb(a)),b},dhtmlXColorPicker.prototype.setColor=function(a){var e,f,b=this.colorAIP.rgb2hex({r:this.value.red,g:this.value.green,b:this.value.blue}),c=this._parseColor(a),d=c instanceof Object;return d=d&&0<=c.r&&c.r<=255,d=d&&0<=c.g&&c.g<=255,(d=d&&0<=c.b&&c.b<=255)?(e=this.colorAIP.rgb2hex({r:c.r,g:c.g,b:c.b}),e==b?b:(this.value.red=c.r,this.value.green=c.g,this.value.blue=c.b,f=this.colorAIP.rgb2hsl(c.r/255,c.g/255,c.b/255),this.value.hue=Math.round(f.h),this.value.sat=Math.round(100*f.s),this.value.lum=Math.round(100*f.l),this._refreshCoordinatesByHSL(this.value.hue,this.value.sat,this.value.lum),this._refreshContrast(),this._refreshInputValues(),this._refreshColorValue(),e)):b},dhtmlXColorPicker.prototype.getSelectedColor=function(){return[this.colorAIP.rgb2hex({r:this.value.red,g:this.value.green,b:this.value.blue}),[this.value.red,this.value.green,this.value.blue],[this.value.hue,this.value.sat,this.value.lum]]},dhtmlXColorPicker.prototype._attachEventsToNode=function(a){"function"==typeof window.addEventListener?a.node.addEventListener("click",this._doOnClickByNode,!1):a.node.attachEvent("onclick",this._doOnClickByNode),a.valueCont&&"input"==a.valueCont.tagName.toLowerCase()&&("function"==typeof window.addEventListener?(a.valueCont.addEventListener("focus",this._doOnFocusByInput,!1),a.valueCont.addEventListener("blur",this._doOnBlurByInput,!1)):(a.valueCont.attachEvent("onfocus",this._doOnFocusByInput),a.valueCont.attachEvent("onblur",this._doOnBlurByInput)))},dhtmlXColorPicker.prototype._detachEventsFromNode=function(a){"function"==typeof window.addEventListener?a.node.removeEventListener("click",this._doOnClickByNode,!1):a.node.detachEvent("onclick",this._doOnClickByNode),a.valueCont&&"input"==a.valueCont.tagName.toLowerCase()&&("function"==typeof window.addEventListener?(a.valueCont.removeEventListener("focus",this._doOnFocusByInput,!1),a.valueCont.removeEventListener("blur",this._doOnBlurByInput,!1)):(a.valueCont.detachEvent("onfocus",this._doOnFocusByInput),a.valueCont.detachEvent("onblur",this._doOnBlurByInput)))},dhtmlXColorPicker.prototype.show=function(a){var b=!1;void 0!=a&&(this.activeNode=this.getNode(a)||this.activeNode),this.activeNode&&this.activeNode.valueCont&&this.activeNode.valueCont.value&&this.setColor(this.activeNode.valueCont.value),this.activeNode?(b=null!=this.activeNode.conf.customColors?this.activeNode.conf.customColors:this.conf.customColors,this.setColor(this.activeNode.conf.selectedColor)):b=this.conf.customColors,b?this.showMemory():this.hideMemory(),this.base._dhx_remove?(this.base.firstChild.style.zIndex=dhx4.zim.reserve(this.conf.cp_id),this.base.style.visibility="hidden",document.body.firstChild?document.body.insertBefore(this.base,document.body.firstChild):document.body.appendChild(this.base),this._refreshPosition(),this.base.style.visibility="visible","function"==typeof window.addEventListener?document.body.addEventListener("mousedown",this._doOnClickByBody,!1):document.body.attachEvent("onmousedown",this._doOnClickByBody)):this.base.appendChild(this._globalNode),this._controllerNodes.fr_cover&&this.base.insertBefore(this._controllerNodes.fr_cover,this._globalNode),this.callEvent("onShow",[this.activeNode?this.activeNode.node:null])},dhtmlXColorPicker.prototype.setPosition=function(a,b){var c=null,d=parseInt(a),e=parseInt(b);isNaN(d)&&(c={right:"right",bottom:"bottom"}[a.toLowerCase()]?a:null),this.base._dhx_remove?null==c||(this.conf.position=c,this._refreshPosition(c)):isNaN(d)||isNaN(e)||(this._globalNode.style.left=d+"px",this._globalNode.style.top=e+"px",this._controllerNodes.fr_cover&&(this._controllerNodes.fr_cover.style.left=this._globalNode.style.left,this._controllerNodes.fr_cover.style.top=this._globalNode.style.top))},dhtmlXColorPicker.prototype._initListenerInput=function(){var a=this;this._inputListenerId=this._inputListenerId||setInterval(function(){a._refreshValueByInput()},70)},dhtmlXColorPicker.prototype._removeListenerInput=function(){this._inputListenerId&&(clearInterval(this._inputListenerId),this._inputListenerId=null)},dhtmlXColorPicker.prototype._refreshValueByInput=function(){var a=this.activeNode.valueCont.value,b=this.getSelectedColor()[0];this._inputListenerId&&/^#[\da-f]{6}$/i.test(a)&&a!=b&&(this.setColor(a),this.callEvent("onSelect",[a,this.activeNode.node]))},dhtmlXColorPicker.prototype._refreshPosition=function(a){var b,c,d,e,f,g,h;if(null!=this.activeNode){switch(b=dhx4.absTop(this.activeNode.node),c=dhx4.absLeft(this.activeNode.node),d=dhx4.screenDim(),e=this._globalNode.offsetWidth,f=this._globalNode.offsetHeight,g=0,a=a||this.conf.position){case"bottom":g=b+this.activeNode.node.offsetHeight+this.conf.indent,h=c,h+e>d.left+d.right&&(h=c+this.activeNode.node.offsetWidth-e),h<d.left&&(h=c),g+f>d.top+d.bottom&&(g=b-f-this.conf.indent),g-d.top<0&&(g=d.top+this.conf.indent),this._globalNode.style.top=g+"px",this._globalNode.style.left=h+"px";break;default:h=c+this.activeNode.node.offsetWidth+this.conf.indent,g=b,"right"==a&&(h+e>d.left+d.right&&(h=c-e-this.conf.indent),h<d.left&&(h=c+this.activeNode.node.offsetWidth+this.conf.indent)),d.bottom-(g+f)<=0&&(g=b+this.activeNode.node.offsetHeight-f),g-d.top<0&&(g=d.top+this.conf.indent),this._globalNode.style.left=h+"px",this._globalNode.style.top=g+"px"}this._controllerNodes.fr_cover&&(this._controllerNodes.fr_cover.style.left=this._globalNode.style.left,this._controllerNodes.fr_cover.style.top=this._globalNode.style.top)}},dhtmlXColorPicker.prototype.isVisible=function(){var a=!1;return a=this.base._dhx_remove?this.base.parentNode==document.body:this._globalNode.parentNode==this.base},dhtmlXColorPicker.prototype.hide=function(){if(this.base._dhx_remove)this.base.parentNode&&(this.base.parentNode.removeChild(this.base),dhx4.zim.clear(this.conf.cp_id),"function"==typeof window.addEventListener?document.body.removeEventListener("mousedown",this._doOnClickByBody,!1):document.body.detachEvent("onmousedown",this._doOnClickByBody));else{if(0==this.isVisible())return;this.base.removeChild(this._globalNode)}this._controllerNodes.fr_cover&&this._controllerNodes.fr_cover.parentNode&&this._controllerNodes.fr_cover.parentNode.removeChild(this._controllerNodes.fr_cover),void 0!=this.callEvent&&this.callEvent("onHide",[this.activeNode?this.activeNode.node:null])},dhtmlXColorPicker.prototype.configColorArea={minX:1,maxX:209,minY:1,maxY:119},dhtmlXColorPicker.prototype._skinCollection={dhx_skyblue:!0,dhx_web:!0,dhx_terrace:!0},dhtmlXColorPicker.prototype.i18n={en:{labelHue:"色调",labelSat:"饱和度",labelLum:"亮度",labelRed:"红",labelGreen:"绿",labelBlue:"蓝",btnAddColor:"保存颜色",btnSelect:"选择",btnCancel:"取消"}},dhtmlXColorPicker.prototype.loadUserLanguage=function(a){"function"==typeof this._mergeLangModules&&this._mergeLangModules(),this.conf.lang=a,this._refreshLanguage()},dhtmlXColorPicker.prototype._refreshLanguage=function(){var a,b=this.i18n[this.conf.lang];for(a in b)this._labelNodes[a]&&(this._labelNodes[a].innerHTML=b[a])},dhtmlXColorPicker.prototype._setColorAreaXY=function(a,b){var c=this.configColorArea;a=parseInt(a),c.minX>a?this.conf.x=c.minX:a>c.maxX?this.conf.x=c.maxX:isNaN(a)||(this.conf.x=a),b=parseInt(b),c.minY>b?this.conf.y=c.minY:b>c.maxY?this.conf.y=c.maxY:isNaN(b)||(this.conf.y=b),this._refreshLines()},dhtmlXColorPicker.prototype._setColorByXYC=function(a){a=a||!1,this.value.hue=Math.round(359*(this.conf.x-this.configColorArea.minX)/(this.configColorArea.maxX-this.configColorArea.minX)),this.value.lum=Math.round(100-100*(this.conf.y-this.configColorArea.minY)/(this.configColorArea.maxY-this.configColorArea.minY)),this.value.sat=Math.round(100-100*(this.conf.c-this.configColorArea.minY)/(this.configColorArea.maxY-this.configColorArea.minY));var b=this.colorAIP.hsl2rgb(this.value.hue,this.value.sat/100,this.value.lum/100);this.value.red=Math.round(255*b.r),this.value.green=Math.round(255*b.g),this.value.blue=Math.round(255*b.b),a||this._refreshContrast(),this._refreshInputValues(),this._refreshColorValue()},dhtmlXColorPicker.prototype._setContrastY=function(a){var b=this.configColorArea;a=parseInt(a),isNaN(a)||(this.conf.c=Math.min(Math.max(b.minY,a),b.maxY)),this._refreshContrastLine()},dhtmlXColorPicker.prototype._refreshInputValues=function(){this._controllerNodes.hue.value=this.value.hue,this._controllerNodes.sat.value=this.value.sat,this._controllerNodes.lum.value=this.value.lum,this._controllerNodes.red.value=this.value.red,this._controllerNodes.green.value=this.value.green,this._controllerNodes.blue.value=this.value.blue},dhtmlXColorPicker.prototype._refreshColorValue=function(){this._controllerNodes.color.style.backgroundColor="rgb("+[this.value.red,this.value.green,this.value.blue].join(", ")+")";var a=this.colorAIP.rgb2hex({r:this.value.red,g:this.value.green,b:this.value.blue});this._controllerNodes.hsv.value=a,this.callEvent("onChange",[a])},dhtmlXColorPicker.prototype._refreshContrast=function(){var d,e,f,a=this.colorAIP.hsl2rgb(this.value.hue,0,this.value.lum/100),b=this.colorAIP.hsl2rgb(this.value.hue,1,this.value.lum/100),c=this._checkIeVersion();c&&9>=c?(d=this._controllerNodes.contrastArea.firstChild,d==this._controllerNodes.contrast_line&&(d=document.createElement("div"),d.className+="dhxcp_ie_gradient",this._controllerNodes.contrastArea.appendChild(d),this._controllerNodes.contrastArea.appendChild(this._controllerNodes.contrast_line)),e=this.colorAIP.rgb2hex({r:Math.round(255*a.r),g:Math.round(255*a.g),b:Math.round(255*a.b)}),f=this.colorAIP.rgb2hex({r:Math.round(255*b.r),g:Math.round(255*b.g),b:Math.round(255*b.b)}),d.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr='"+f+"', endColorstr='"+e+"', GradientType=0)"):(a=[Math.round(255*a.r),Math.round(255*a.g),Math.round(255*a.b)],b=[Math.round(255*b.r),Math.round(255*b.g),Math.round(255*b.b)],this._controllerNodes.contrastArea.style.backgroundImage="linear-gradient(to top, rgb("+a.join(",")+"), rgb("+b.join(",")+"))")},dhtmlXColorPicker.prototype._refreshLines=function(){this._controllerNodes.v_line.style.left=this.conf.x+"px",this._controllerNodes.h_line.style.top=this.conf.y+"px"},dhtmlXColorPicker.prototype._refreshContrastLine=function(){this._controllerNodes.contrast_line.style.top=this.conf.c+"px"},dhtmlXColorPicker.prototype._getOffsetPosition=function(a,b){var c={x:0/0,y:0/0},d=a.target||a.srcElement;return d==b?(c.x=void 0!=a.offsetX?a.offsetX:a.layerX,c.y=void 0!=a.offsetY?a.offsetY:a.layerY):d==this._controllerNodes.v_line?c.y=void 0!=a.offsetY?a.offsetY:a.layerY:c.x=void 0!=a.offsetX?a.offsetX:a.layerX,c},dhtmlXColorPicker.prototype.colorAIP={hex2rgb:function(a){var b=a.match(/^(#)([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);return null!=b?{r:parseInt("0x"+b[2]),g:parseInt("0x"+b[3]),b:parseInt("0x"+b[4])}:null},rgb2hex:function(a){var b=parseInt(a.r),c=parseInt(a.g),d=parseInt(a.b);return b=b||0,c=c||0,d=d||0,"#"+(b?16>b?"0"+b.toString(16):b.toString(16):"00")+(c?16>c?"0"+c.toString(16):c.toString(16):"00")+(d?16>d?"0"+d.toString(16):d.toString(16):"00")},rgb2hsl:function(a,b,c){var d,e,g=Math.max(a,b,c),h=Math.min(a,b,c),f=.5*(g+h);return g==h?d=0:g==a?(d=60*(b-c)/(g-h),c>b&&(d+=360)):d=g==b?60*(c-a)/(g-h)+120:60*(a-b)/(g-h)+240,e=0==f||g==h?0:.5>=f?.5*(g-h)/f:.5*(g-h)/(1-f),{h:d,s:e,l:f}},hsl2rgb:function(a,b,c){var d,e,f,i,g=[],h=[];for(d=.5>=c?c*(1+b):c+b-c*b,e=2*c-d,f=a/360,g.push(f+1/3),g.push(f),g.push(f-1/3),i=0;3>i;i++)g[i]<0?g[i]+=1:g[i]>1&&(g[i]-=1),g[i]<1/6?h.push(e+6*(d-e)*g[i]):g[i]<.5?h.push(d):g[i]<2/3?h.push(e+6*(d-e)*(2/3-g[i])):h.push(e);return{r:h[0],g:h[1],b:h[2]}}},dhtmlXColorPicker.prototype._checkIeVersion=function(){var b=navigator.userAgent.match(/(MSIE)\s(\d\.\d)/i),a=b&&b[2]?parseInt(b[2]):null;return a},dhtmlXColorPicker.prototype.setCustomColors=function(){null==this.memory&&(this.initMemoryColors(),this.conf.customColors=!0);var a,b,c,d,e,f;for(b=arguments.length,a=0;b>a;a++)if(arguments[a]instanceof Array)c=this._rgb2value(arguments[a][0],arguments[a][1],arguments[a][2]),this.memory.setValue(c,null,!1);else if("string"==typeof arguments[a]){if(d=arguments[a].match(/^rgb\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\)$/i),d instanceof Array){c=this._rgb2value(d[1],d[2],d[3]),this.memory.setValue(c,null,!1);continue}if(d=arguments[a].match(/(#[\da-f]{6})/gi),d instanceof Array)for(f=d.length,e=0;f>e;e++)c=this._hex2value(d[e]),this.memory.setValue(c,null,!1)}},dhtmlXColorPicker.prototype.getCustomColors=function(){var b,c,a=[];if(null!=this.memory&&1==this.conf.customColors)for(b=0;b<this.memory.controllers.length;b++)c=this.memory.controllers[b].value,a.push(this.colorAIP.rgb2hex({r:c.red,g:c.green,b:c.blue}));return a},dhtmlXColorPicker.prototype._rgb2value=function(a,b,c){var d=this.colorAIP.rgb2hsl(a/255,b/255,c/255);return{red:a,green:b,blue:c,hue:Math.round(d.h),sat:Math.round(100*d.s),lum:Math.round(100*d.l)}},dhtmlXColorPicker.prototype._hex2value=function(a){var b,c;return b=this.colorAIP.hex2rgb(a),c=this.colorAIP.rgb2hsl(b.r/255,b.g/255,b.b/255),{red:b.r,green:b.g,blue:b.b,hue:Math.round(c.h),sat:Math.round(100*c.s),lum:Math.round(100*c.l)}},dhtmlXColorPicker.prototype.showMemory=function(){null==this.memory&&this.initMemoryColors(),this._globalNode.className.match(/dhxcp_add_memory/)||(this._globalNode.className+=" dhxcp_add_memory"),this.conf.customColors=!0},dhtmlXColorPicker.prototype.hideMemory=function(){null!=this.memory&&(this._globalNode.className=this._globalNode.className.replace(/\sdhxcp_add_memory/,"")),this.conf.customColors=!1},dhtmlXColorPicker.prototype.setSkin=function(a){a=a.toLowerCase();var b,d,c=-1,e="dhtmlxcp";if(b=this.base.className.match(/\S\w+/gi),b instanceof Array){for(d in this._skinCollection){if(-1!=c)break;c=this._indexOf(b,e+"_"+d)}c=-1==c?b.length:c}else b=[],c=0;b[c]=e+"_"+a,this.base.className=b.join(" "),this.skin=a},dhtmlXColorPicker.prototype.hideOnSelect=function(a){a=dhx4.s2b(a),this.conf.hideOnSelect=a},dhtmlXColorPicker.prototype._indexOf=function(a,b){var c,d,e=-1;for(d=a.length,c=d;c>=0;c--)if(a[c]==b){e=c;break}return e},dhtmlXColorPicker.prototype.destructMemory=function(){if(null!=this.memory){this.hideMemory();var a=this._controllerNodes.memory_block.childNodes[0].firstChild;this._labelNodes.btnAddColor=null,"function"==typeof window.addEventListener?a.removeEventListener("click",this.saveColor,!1):a.detachEvent("onclick",this.saveColor),this.memory.remove(),this._controllerNodes.memory_block.innerHTML="",this.memory=null}},dhtmlXColorPicker.prototype.Memory=function(a){var b=this,c=null,d={red:255,blue:255,green:255,hue:0,sat:0,lum:100};this.select=function(){var a=this!=window?this:event.srcElement,d=d||a.dhxpc_memory;null!=c&&b.unSelect(),c=d,d.domElement.className+=" dhxcp_memory_el_select","function"==typeof b.onSelect&&b.onSelect(d)
},this.onSelect=null,this.onSave=null,this._createMemoryController=function(a){var c={domElement:a,value:dhx4._copyObj(d)};return a.dhxpc_memory=c,"function"==typeof window.addEventListener?a.addEventListener("click",b.select,!1):a.attachEvent("onclick",b.select),c},this._findMemoryControllers=function(a){var c,d,b=a.getElementsByTagName("a"),e=[];for(d=b.length,c=0;d>c;c++)e.push(this._createMemoryController(b[c]));return e},this.controllers=this._findMemoryControllers(a),this.unSelect=function(){c&&(c.domElement.className=c.domElement.className.replace(/\s.*$/i,"")),c=null},this.setActiveNext=function(){var b,a=null;return null==c?c=this.controllers[0]:(a=this.getIndex(c),b=this.controllers.length,this.unSelect(),c=b>a+1?this.controllers[a+1]:this.controllers[0]),c.domElement.className+=" dhxcp_memory_el_next",c},this.setValue=function(a,b,d){c=b||c,null==c&&(c=this.controllers[0]),c.value.red=a.red,c.value.blue=a.blue,c.value.green=a.green,c.value.hue=a.hue,c.value.sat=a.sat,c.value.lum=a.lum,c.domElement.style.backgroundColor="rgb("+[a.red,a.green,a.blue].join(", ")+")",this.setActiveNext(),0!=d&&"function"==typeof this.onSave&&this.onSave(a)},this.clean=function(){var b,e,a=this.controllers.length;for(e=0;a>e;e++)b=this.controllers[e],b.value=dhx4._copyObj(d),b.domElement.style.backgroundColor="rgb("+[d.red,d.green,d.blue].join(", ")+")";this.unSelect(),c=this.controllers[0]},this.getIndex=function(a){var b,c,d=-1;for(c=this.controllers.length,b=0;c>b;b++)if(this.controllers[b]==a){d=b;break}return d},this.remove=function(){var a,b;for(b=this.controllers.length,a=0;b>a;a++)"function"==typeof window.addEventListener?this.controllers[a].domElement.removeEventListener("click",this.select,!1):this.controllers[a].domElement.detachEvent("onclick",this.select),delete this.controllers[a].domElement.dhxpc_memory;delete this.onSelect,delete this.controllers,delete this.onSave}},window.dhx4.isIE6&&(dhtmlXColorPicker.prototype._cpInitFRM=function(){var a;this._controllerNodes.fr_cover||(a=document.createElement("IFRAME"),a.className="dhxcp_frm",a.border=0,a.frameBorder=0,this._controllerNodes.fr_cover=a),this.base._dhx_remove||this.base.insertBefore(a,this._globalNode)});